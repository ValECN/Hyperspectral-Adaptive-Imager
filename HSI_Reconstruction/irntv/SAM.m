%========================================================
%========================================================

% Calculate the SAM metric
%function y = SAM(I1, I2)
I1 = I;
I2 = I_Threshold;
[~,~,W] = size(I1);
score = 0;
for w = 1:W
    s1 = I1(:,:,w);
    s2 = I2(:,:,w);
    body(:,:,w) = (s1'*s2)/norm(s1) * norm(s2);
    score(w) = score + norm(acos(body(:,:,w)));
end
y = (2*score/(pi*W));
return


%========================================================
%========================================================